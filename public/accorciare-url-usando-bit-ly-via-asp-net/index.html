<!DOCTYPE html>
<html lang="en-US">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Come accorciare links e URL usando le API di Bit.ly via ASP.NET"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="Come accorciare links e URL usando le API di Bit.ly via ASP.NET &middot; Nicola Iarocci" />
  	<meta property="og:site_name" content="Nicola Iarocci" />
  	<meta property="og:url" content="https://nicolaiarocci.com/accorciare-url-usando-bit-ly-via-asp-net/" />

    
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2010-11-29T00:00:00Z" />

    
    <meta property="article:tag" content="api" />
    
    <meta property="article:tag" content="asp.net" />
    
    <meta property="article:tag" content="httpwebrequest" />
    
    <meta property="article:tag" content="url shortener" />
    
    

    <title>Come accorciare links e URL usando le API di Bit.ly via ASP.NET &middot; Nicola Iarocci</title>

    
    <meta name="description" content="&lt;p&gt;&lt;img class=&#34;alignright size-full wp-image-1152&#34; title=&#34;DotNet Logo&#34; src=&#34;http://i2.wp.com/nicolaiarocci.com/wp-content/uploads/dotnet-logo-new.jpg?fit=221%2C" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    
    <link rel="stylesheet" href="/css/custom.css">
    

    

    
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Nicola Iarocci" />
      
      
    
    <meta name="generator" content="Hugo 0.55.4" />

    <link rel="canonical" href="https://nicolaiarocci.com/accorciare-url-usando-bit-ly-via-asp-net/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null 
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "url": "https://nicolaiarocci.com",
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "Come accorciare links e URL usando le API di Bit.ly via ASP.NET",
    "name": "Come accorciare links e URL usando le API di Bit.ly via ASP.NET",
    "wordCount":  563 ,
    "timeRequired": "PT3M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "https://nicolaiarocci.com/accorciare-url-usando-bit-ly-via-asp-net/",
    "datePublished": "2010-11-29T00:00Z",
    "dateModified": "2010-11-29T00:00Z",
    
    "keywords": "api, asp.net, httpwebrequest, url shortener",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://nicolaiarocci.com/accorciare-url-usando-bit-ly-via-asp-net/"
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-19006041-1', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/">Blog</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/about">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/opensource">Open Source</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/talks">Speaking</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/books-i-have-read">Reading</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/il-piccolo-libro-di-mongodb-edizione-italiana">MongoDB</a>
            </li>
        
            <h3>Subscribe</h3>
            <li class="nav-opened" role="presentation">
            	<a href="http://eepurl.com/b-_Pzz">New posts via mail</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://nicolaiarocci.com/index.xml">RSS feed</a>
            </li>
        
            <h3>Follow me</h3>
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/nicolaiarocci">Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/nicolaiarocci">Github</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://stackoverflow.com/users/323269/nicola-iarocci?tab=profile">Stack Overflow</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://speakerdeck.com/u/nicola">Speaker Deck</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://www.linkedin.com/in/nicolaiarocci">LinkedIn</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">



<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Come accorciare links e URL usando le API di Bit.ly via ASP.NET</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2010-11-29T00:00:00Z">
            Nov 29, 2010
          </time>
        
         
          <span class="post-tag small"><a href="https://nicolaiarocci.com//tags/api/">#api</a></span>
         
          <span class="post-tag small"><a href="https://nicolaiarocci.com//tags/asp.net/">#asp.net</a></span>
         
          <span class="post-tag small"><a href="https://nicolaiarocci.com//tags/httpwebrequest/">#httpwebrequest</a></span>
         
          <span class="post-tag small"><a href="https://nicolaiarocci.com//tags/url-shortener/">#url shortener</a></span>
         
        </section>
    </header>

    <section class="post-content">
      <p><img class="alignright size-full wp-image-1152" title="DotNet Logo" src="http://i2.wp.com/nicolaiarocci.com/wp-content/uploads/dotnet-logo-new.jpg?fit=221%2C210" alt="DotNet Logo" srcset="http://i2.wp.com/nicolaiarocci.com/wp-content/uploads/dotnet-logo-new.jpg?w=221 221w, http://i2.wp.com/nicolaiarocci.com/wp-content/uploads/dotnet-logo-new.jpg?resize=150%2C142 150w" sizes="(max-width: 221px) 100vw, 221px" data-recalc-dims="1" />Una delle applicazioni su cui sto lavorando in questo periodo manda decine di emails al giorno, ognuna contenente almeno un paio di links (URL). Questi link sono molto lunghi perché oltre all&#8217;indirizzo della pagina da aprire contengono una o più <a href="http://en.wikipedia.org/wiki/Query_string">query strings</a>. In generale, per tante buone ragioni, le URL lunghe non sono mai una buona idea; ancor meno lo sono se  devono comparire in un messaggio email. Gli algoritmi di <a href="http://en.wikipedia.org/wiki/Word_wrap">word wrapping</a> dei client di posta elettronica vanno in crisi quando sono costretti a inserire un ritorno di carrello nel bel mezzo della URL. Come biasimarli?</p>

<p>Ci sono poi certi sistemi di web mail (quello di Libero, per non far nomi) che semplicemente non sono capaci di riprodurre correttamente un link o se lo fanno non attivano il link per ragioni di sicurezza, lasciando così al destinatario della mail il compito di copiare e incollare l&#8217;intera URL nel browser. Operazione non sempre banale per l&#8217;utente medio, soprattutto quando (guarda caso!) il testo da copiare e incollare è lunghissimo.</p>

<p>Si potrebbe risolvere banalmente ricorrendo agli <a href="http://www.w3schools.com/HTML/html_links.asp">anchor tag HTML</a> ma nel mio caso questa strada non è praticabile: i messaggi devono essere in puro testo. Non solo, questa soluzione non risolverebbe comunque il problema dei web mail client che non si fidano dei miei messaggi. Creare a priori URL brevi non è una opzione per ragioni di legacy (il sito non l&#8217;ho creato io!). Come fare allora?</p>

<h2 id="chiedere-aiuto-a-un-servizio-url-shortener">Chiedere aiuto a un servizio URL Shortener</h2>

<p>Gli <a href="http://it.wikipedia.org/wiki/URL_shortening">URL shortener</a> sono servizi molto usati in ambito social networking e non solo. Data una certa URL di qualunque lunghezza ne restituiscono una equivalente molto più breve. Pioniere in questo campo è stato TinyURL ma oggigiorno il servizio più diffuso e conosciuto è senz&#8217;altro <a href="http://bit.ly/">Bit.ly</a>, il quale ha l&#8217;indubbio vantaggio di offrire una <a href="http://it.wikipedia.org/wiki/Representational_State_Transfer">REST API</a> ricca, robusta e <a href="http://code.google.com/p/bitly-api/wiki/ApiDocumentation#bit.ly_API_Documentation">ben documentata</a>. Questa libreria gratuita consente ai programmatori indipendenti (noi) l&#8217;implementazione di servizi di URL shortening nelle proprie applicazioni.</p>

<p>Ecco dunque <strong>ShortenUrl</strong>, una semplice funzione ASP.NET che restituisce una URL breve a partire da una URL di qualunque lunghezza passata come parametro. Nel caso la chiamata alla API fallisca la funzione restituirà semplicemente una stringa vuota.</p>

<pre class="brush:vb">Public Function ShortenUrl(ByVal url As String) As String
        Const login As String = "Il_tuo_Bitly_Username"
        Const apiKey As String = "La_tua_Bitly_ApiKey"
        Dim encodedUrl As String = HttpUtility.UrlEncode(url)
        Dim requestUri As String = String.Format("http://api.bit.ly/v3/shorten?login={0}&apiKey={1}&longUrl={2}&format=txt", login, apiKey, encodedUrl)
        Dim reg As HttpWebRequest = HttpWebRequest.Create(requestUri)
        reg.Timeout = 10000
        Dim shortUrl As String = String.Empty
        Try
            shortUrl = New StreamReader(reg.GetResponse().GetResponseStream).ReadLine
        Catch ex As Exception
            'in caso di errore non facciamo nulla perché vogliamo restituire semplicemente una stringa vuota.
            'potremmo sollevare una eccezione, loggare l'errore, ecc.
        End Try
        Return shortUrl
    End Function</pre>

<p>La gran parte del lavoro è fatto da una sola linea di codice (ok, avrei potuto suddividerla in due o tre linee per amor di chiarezza, te lo concedo). La richiesta REST al servizio è eseguita da una istanza della classe <a href="http://msdn.microsoft.com/it-it/library/system.net.httpwebrequest(v=VS.90).aspx">HttpWebRequest</a>. Il <a href="http://code.google.com/p/bitly-api/wiki/ApiDocumentation#/v3/shorten">metodo Shorten</a> può restituire risultati in formato <a href="http://it.wikipedia.org/wiki/JSON">JSON</a>, <a href="http://it.wikipedia.org/wiki/XML">XML</a> o puro testo. Per semplicità ho scelto il formato testo. A seconda delle necessità potresti ricorrere al bellissimo formato JSON o al logorroico XML,  la documentazione ufficiale contiene esempi molto chiari anche per questi formati.</p>

<p>Se non disponi di un account Bit.ly dovrai <a href="http://bit.ly/a/sign_up">registrarti</a> (è gratis). Una volta creato l&#8217;account potrai recuperare facilmente la tua <a href="http://bit.ly/a/your_api_key">API Key personale</a>, indispensabile per poter effettuare chiamate ai metodi della libreria.</p>
    </section>


  <footer class="post-footer">


    









<section class="author">
  <h4><a href="https://nicolaiarocci.com/">Nicola Iarocci</a></h4>
  
  <p>Read <a href="https://nicolaiarocci.com/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Ravenna, Italy</span>
    <span class="author-link icon-link"><a href="https://nicolaiarocci.com">https://nicolaiarocci.com</a></span>
  </div>
</section>




    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Come%20accorciare%20links%20e%20URL%20usando%20le%20API%20di%20Bit.ly%20via%20ASP.NET&nbsp;-&nbsp;Nicola%20Iarocci&amp;url=https%3a%2f%2fnicolaiarocci.com%2faccorciare-url-usando-bit-ly-via-asp-net%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fnicolaiarocci.com%2faccorciare-url-usando-bit-ly-via-asp-net%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fnicolaiarocci.com%2faccorciare-url-usando-bit-ly-via-asp-net%2f&amp;description=Come%20accorciare%20links%20e%20URL%20usando%20le%20API%20di%20Bit.ly%20via%20ASP.NET"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fnicolaiarocci.com%2faccorciare-url-usando-bit-ly-via-asp-net%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    







  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/python-e-il-linguaggio-del-2011/">
          <section class="post">
              <h2>E’ Python il linguaggio del 2011</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/programmazione-asincrona/">
          <section class="post">
              <h2>Programmazione Asincrona per C# e VB</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Nicola Iarocci</a> All rights reserved</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
</body>
</html>

